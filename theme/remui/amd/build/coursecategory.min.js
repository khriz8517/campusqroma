"use strict";define(["jquery","theme_remui/bootstrap-select","core/templates","theme_remui/jquery-toolbar","core/ajax","core/str","core/notification"],function(e,t,a,r,i,n,s){var o,c,l=e("select#sortfilter.selectpicker"),d=e("#coursesearch2"),u=e("select#categoryfilter.selectpicker"),g=e("#coursestab"),p=e("#mycoursestab"),v=e("#coursesregion div.content"),f=e("#mycoursesregion div.content"),h=e("#coursespagination"),m=e("#mycoursespagination"),b=e(".togglebtn"),y="theme_remui/course_card_grid",w="theme_remui/course_card_list",_=".page-header-actionss";function C(){o.isFilterModified&&function(){e(".courses-tabs .courses-loader-wrap").show();var t=o.tab?f:v,r=o.tab?m:h;i.call([{methodname:"theme_remui_get_courses",args:{data:JSON.stringify(o)}}])[0].done(function(i){i=JSON.parse(i),e(_).empty(),1==i.hasmanagebutton&&e(_).append(i.managebuttons),null!=i.dropdown?e("#page-header .page-header-actionss").append(i.dropdown):e('#page-header .page-header-actionss [data-enhance="moodle-core-actionmenu"]').remove();var n=null===o.view?i.view:o.view,l="grid"==n||i.latest_card?y:w;(window.screen.width<=480||i.latest_card)&&(l=y,n="grid"),"grid"==n?(o.view="grid",e(".tab-content").addClass("grid-view").removeClass("list-view"),e(".grid_btn").addClass("btn-primary active"),e(".list_btn").removeClass("btn-primary active")):(o.view="list",e(".tab-content").addClass("list-view").removeClass("grid-view"),e(".grid_btn").removeClass("btn-primary active"),e(".list_btn").addClass("btn-primary active")),i.latest_card?(e(".tab-content").addClass("latest-cards"),e(".viewtoggler").addClass("hidden")):(e(".tab-content").removeClass("latest-cards"),e(".viewtoggler").removeClass("hidden"));var d=i.courses;if(d.length>0)for(var u=0;u<d.length;u++)a.render(l,d[u]).then(function(r,n){a.appendNodeContents(t,r,n),o.tab||i.latest_card||e(".showoptions").each(function(){e(this).toolbar({content:e(this).data("toolbar"),style:"primary"})})}).fail(s.exception);else{var g='<div class="alert alert-warning alert-dismissible  w-full mx-10" role="alert">';g+='<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span><span class="sr-only">Close</span></button>'+c[0]+"</div>",a.appendNodeContents(t,g,"")}o.pagination&&a.appendNodeContents(r,i.pagination,""),e(".courses-tabs .courses-loader-wrap").hide()}).fail(s.exception)}()}function k(){!function(){var t=o.tab?f:v;if(e(t).empty(),o.pagination){var a=o.tab?m:h;e(a).empty()}}(),C()}e(document).ready(function(){n.get_strings([{key:"nocoursefound",component:"theme_remui"}]).then(function(t){var a,r;c=t,(r={category:"all",sort:null,search:"",tab:!1,page:a={courses:0,mycourses:0},pagination:!0,view:null,isFilterModified:!0}).initAttributes=function(){r.category="all",r.sort=null,r.search="",r.tab=!1,r.page=a,r.pagination=!0,r.view=null,r.isFilterModified=!0},r.initPagination=function(){r.page={courses:0,mycourses:0}},o=r;for(var i,n=[],s=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),l=0;l<s.length;l++)i=s[l].split("="),n.push(i[0]),n[i[0]]=i[1];n.categoryid&&0!=n.categoryid&&(o.category=n.categoryid),null!=n.categorysort&&(o.sort=n.categorysort),null!=n.search&&(o.search=n.search),n.mycourses&&0!=n.mycourses&&(o.tab=!0,e("body").hasClass("notloggedin")&&(o.tab=!1)),function(t){e(".selectpicker").each(function(){e(this).selectpicker()}),"0"!==t.category&&e("#categoryfilter.selectpicker").selectpicker("val",t.category);null!==t.sort&&e("#sortfilter.selectpicker").selectpicker("val",t.sort);""!==t.sort&&e("#coursesearchbox").val(t.search);e(".category-filters").removeClass("d-none")}(o),C()})}),e(document).delegate(".tool-item","click",function(){window.location=e(this).attr("href")}),e(u).on("changed.bs.select",function(e){o.category=e.target.value,o.initPagination(),k()}),e(l).on("changed.bs.select",function(e){o.sort=e.target.value,k()}),e(g).on("click",function(){o.tab=!1,k()}),e(p).on("click",function(){o.tab=!0,k()}),e(d).on("submit",function(t){t.preventDefault(),o.initPagination(),o.search=e("#coursesearchbox").val(),k()}),e(b).on("click",function(){var t=e(this).attr("data-view");o.view=t,M.util.set_user_preference("course_view_state",t,null),k()}),e(b).keypress(function(t){if(32==t.keyCode||13==t.keyCode)try{t.preventDefault();var a=e(this).attr("data-view");o.view=a,M.util.set_user_preference("course_view_state",a,null),k()}catch(t){console.log(t)}}),e(document).delegate(".tab-pane .pagination .page-item .page-link","click",function(e){e.preventDefault();var t=e.target.href;void 0===t&&void 0===(t=e.target.parentElement.href)&&(t=e.target.parentElement.parentElement.href);for(var a,r=t.slice(t.indexOf("?")+1).split("&"),i=[],n=0;n<r.length;n++)a=r[n].split("="),i.push(a[0]),i[a[0]]=a[1];o.tab?o.page.mycourses=i.page:o.page.courses=i.page,k()})});
//# sourceMappingURL=coursecategory.min.js.map
