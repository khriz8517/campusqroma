define(["jquery","core/templates","core/fragment","core/modal_factory","core/modal_events","core/str","local_edwiserreports/variables","local_edwiserreports/common"],(function(e,t,o,r,n,l,i){return{init:function(a){var c="#wdm-lpstats-individual",d="#wdm-lp-select",s=c+" .table",p=c+" .loader",f=e("#wdm-userfilter .row .col-md-6:first-child"),m=e(c).find("#wdm-lp-dropdown"),u=null,h=e("#wdm-export-detail-lpsreports"),g=null,w=l.get_strings([{key:"lpdetailedreport",component:"local_edwiserreports"}]),v=0;function y(r,n){u&&(u.destroy(),e(s).hide(),e(p).show()),o.loadFragment("local_edwiserreports","lpstats",a,{lpid:r,cohortid:n}).done((function(o){var r=JSON.parse(o);t.render("local_edwiserreports/lpstatsinfo",r).then((function(e,o){t.replaceNode(s,e,o)})).fail((function(e){console.log(e)})).always((function(){e(s).show(),u=e(s).DataTable({dom:"<'pull-left'f><t><p>",oLanguage:{sEmptyTable:"No Users are enrolled in any Learning Programs"},responsive:!0}),e(p).hide()}))}))}e(document).ready((function(){f.html(m.html()),e(document).find(d).select2(),e(document).find(d).show(),m.remove();var o=e(document).find(d).val();y(o,v),e(i.cohortFilterItem).on("click",(function(){v=e(this).data("cohortid"),e(i.cohortFilterBtn).html(e(this).text()),i.changeExportUrl(v,i.exportUrlLink,i.cohortReplaceFlag),y(o,v)})),e(document).find(d).on("change",(function(){e(s).hide(),e(p).show(),o=e(document).find(d).val(),i.changeExportUrl(o,i.exportUrlLink,i.filterReplaceFlag),y(o,v)})),h.on("click",(function(){var o;o=h,g?g.show():w.then((function(){r.create({title:M.util.get_string("lpdetailedreport","local_edwiserreports")},o).done((function(o){var r=o.getRoot();g=o,r.on(n.cancel,(function(){o.hide()})),o.setBody(t.render("local_edwiserreports/lpdetailedreport",{sesskey:e(c).data("sesskey"),formaction:M.cfg.wwwroot+"/local/edwiserreports/download.php"})),o.show()}))}))}))}))}}}));
