define(["jquery","core/chartjs","local_edwiserreports/defaultconfig","local_edwiserreports/variables","./common","local_edwiserreports/select2"],(function(e,o,r,a,s){return{init:function(t){var l=null,n=r.getPanel("#courseprogressblock"),c=r.getPanel("#courseprogressblock","body"),d=(r.getPanel("#courseprogressblock","header"),r.getPanel("#courseprogressblock","footer"),c+" #wdm-courseprogress-select"),i=c+" .ct-chart",g=c+" .loader",p=n+" .dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item",u=!1,f=e(n+" form.download-links");function h(){var c=e(d).val();r.changeExportUrl(c,p,a.filterReplaceFlag),console.log(f.find('input[name="filter"]')),console.log(f),f.find('input[name="filter"]').val(c),l&&l.destroy(),s.loader.show("#courseprogressblock"),e.ajax({url:r.requestUrl,type:r.requestType,dataType:r.requestDataType,data:{action:"get_courseprogress_graph_data_ajax",sesskey:e(n).data("sesskey"),data:JSON.stringify({courseid:c})}}).done((function(e){u.graph.data=e.data})).fail((function(e){console.log(e)})).always((function(){var r;r={labels:u.graph.labels,datasets:[{label:u.graph.label,data:u.graph.data,backgroundColor:u.graph.backgroundColor}]},l=new o(u.ctx,{data:r,type:u.graph.type,options:u.graph.options}),e(g).hide(),e(i).fadeIn("slow"),t("courseProgress"),s.loader.hide("#courseprogressblock")}))}e(document).ready((function(e){(u=r.getCourseProgressBlock())?(h(),e(c+" .singleselect").select2(),e(d).on("change",(function(){e(i).hide(),e(g).show(),h()}))):t("courseProgress")}))}}}));
