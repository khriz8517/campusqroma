define(["jquery","core/chartjs","local_edwiserreports/defaultconfig","./common"],(function(t,a,o,i){return{init:function(c){var e,y=o.getPanel("#todaysactivityblock"),d=o.getPanel("#todaysactivityblock","body"),l=y+" #flatpickrCalender";function s(l){i.loader.show("#todaysactivityblock");var s=t(y).data("sesskey");t.ajax({url:o.requestUrl,type:o.requestType,dataType:o.requestDataType,data:{action:"get_todaysactivity_data_ajax",sesskey:s,data:JSON.stringify({date:l})}}).done((function(i){t.each(i.data,(function(a,o){t(d+" #todays-"+a).find(".data").html(o)})),function(t){o.todaysActivityBlock.graph.data=t;t={labels:o.todaysActivityBlock.graph.labels,datasets:[{label:o.todaysActivityBlock.graph.labelName,data:o.todaysActivityBlock.graph.data,backgroundColor:o.todaysActivityBlock.graph.backgroundColor}]};e&&e.destroy();e=new a(o.todaysActivityBlock.ctx,{type:o.todaysActivityBlock.graph.type,options:o.todaysActivityBlock.graph.options,data:t})}(i.data.visitshour)})).fail((function(t){console.log(t)})).always((function(){c("todaysActivity"),i.loader.hide("#todaysactivityblock")}))}t(document).ready((function(){o.todaysActivityBlock=o.getTodaysActivityBlock(),o.todaysActivityBlock?(s(),t(l).flatpickr({dateFormat:"d M Y",maxDate:"today",defaultDate:["today"],onChange:function(t,a,o){s(a)}})):c("todaysActivity")}))}}}));
